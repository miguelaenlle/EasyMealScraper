digestible_keys = ['protein',
 'energy',
 'carbohydrates',
 'total_fats',
 'fatty_acids_total_saturated_200',
 'fatty_acids_total_saturated_183_undifferentiated',
 'fatty_acids_total_polyunsaturated_171',
 'fatty_acids_total_trans-monoenoic',
 'fatty_acids_total_saturated_204_undifferentiated',
 'fatty_acids_total_saturated_40',
 'fatty_acids_total_trans',
 'riboflavin',
 'tocopherol_beta',
 'lactose',
 'fatty_acids_total_saturated_225_n-3_',
 'fatty_acids_total_polyunsaturated_241_c',
 'fatty_acids_total_saturated_184',
 'fatty_acids_total_saturated_180',
 'tocopherol_delta',
 'arginine',
 'proline',
 'fatty_acids_total_polyunsaturated_181_t',
 'campesterol',
 'glucose_',
 'adjusted_protein',
 'cystine',
 'tocotrienol_beta',
 'selenium_se',
 'copper_cu',
 'maltose',
 'zinc_zn',
 'total_lipid_',
 'vitamin_k_',
 'cholesterol',
 'fatty_acids_total_saturated_221_undifferentiated',
 'fatty_acids_total_trans-polyenoic_183_n-3_ccc_',
 'menaquinone-4',
 'phytosterols',
 'folate_total',
 'fatty_acids_total_trans-polyenoic_203_n-6',
 'vitamin_a_iu',
 'energy',
 'fatty_acids_total_saturated_161_undifferentiated',
 'fatty_acids_total_saturated_141',
 'vitamin_d2_',
 'methionine',
 'fatty_acids_total_saturated_205_n-3_',
 'sugars_total',
 'folic_acid',
 'tocotrienol_alpha',
 'vitamin_c_total_ascorbic_acid',
 'lutein__zeaxanthin',
 'fatty_acids_total_saturated_226_n-3_',
 'vitamin_b-12_added',
 'valine',
 'fatty_acids_total_trans-polyenoic_181-11_t_',
 'fatty_acids_total_polyunsaturated_221_c',
 'magnesium_mg',
 'fatty_acids_total_saturated_160',
 'carbohydrate_by_difference',
 'vitamin_d',
 'fructose',
 'fluoride_f',
 'aspartic_acid',
 'tyrosine',
 'potassium_k',
 'fatty_acids_total_saturated_120',
 'vitamin_a_rae',
 'serine',
 'fatty_acids_total_trans-polyenoic_215',
 'phenylalanine',
 'fatty_acids_total_trans-polyenoic_224',
 'alcohol_ethyl',
 'fatty_acids_total_polyunsaturated_240',
 'fatty_acids_total_saturated_220',
 'fatty_acids_total_saturated_140',
 'histidine',
 'isoleucine',
 'fatty_acids_total_polyunsaturated_182_clas',
 'niacin',
 'water',
 'fatty_acids_total_saturated_80',
 'tocotrienol_delta',
 'theobromine',
 'fatty_acids_total_polyunsaturated_202_n-6_cc',
 'carotene_beta',
 'sodium_na',
 'iron_fe',
 'energy',
 'ash',
 'caffeine',
 'glycine',
 'fatty_acids_total_trans-polyenoic',
 'fatty_acids_total_polyunsaturated_183_n-6_ccc',
 'fatty_acids_total_saturated_182_undifferentiated',
 'fatty_acids_total_polyunsaturated',
 'vitamin_e_',
 'sucrose',
 'vitamin_b-6',
 'fatty_acids_total_trans-polyenoic_130',
 'fatty_acids_total_saturated_60',
 'vitamin_d_',
 'vitamin_d3_',
 'lysine',
 'beta-sitosterol',
 'fatty_acids_total_polyunsaturated_203_undifferentiated',
 'fatty_acids_total_trans-polyenoic_151',
 'lycopene',
 'starch',
 'pantothenic_acid',
 'fatty_acids_total_trans-polyenoic_204_n-6',
 'fatty_acids_total_polyunsaturated_182_tt',
 'fatty_acids_total_polyunsaturated_150',
 'fatty_acids_total_trans-polyenoic_183i',
 'thiamin',
 'folate_food',
 'fatty_acids_total_saturated_201',
 'fatty_acids_total_monounsaturated',
 'stigmasterol',
 'fatty_acids_total_polyunsaturated_182_n-6_cc',
 'fatty_acids_total_polyunsaturated_161_t',
 'fatty_acids_total_polyunsaturated_170',
 'fatty_acids_total_polyunsaturated_182_i',
 'hydroxyproline',
 'dihydrophylloquinone',
 'choline_total',
 'fatty_acids_total_polyunsaturated_161_c',
 'fatty_acids_total_saturated',
 'vitamin_b-12',
 'calcium_ca',
 'fatty_acids_total_saturated_100',
 'galactose',
 'tocotrienol_gamma',
 'alanine',
 'glutamic_acid',
 'fatty_acids_total_trans-polyenoic_203_n-3',
 'carotene_alpha',
 'vitamin_e_added',
 'retinol',
 'leucine',
 'folate_dfe',
 'fatty_acids_total_polyunsaturated_221_t',
 'fatty_acids_total_polyunsaturated_182_t_not_further_defined',
 'fiber_total_dietary',
 'tryptophan',
 'threonine',
 'fatty_acids_total_polyunsaturated_181_c',
 'manganese_mn',
 'cryptoxanthin_beta',
 'fatty_acids_total_saturated_181_undifferentiated',
 'betaine',
 'phosphorus_p',
 'tocopherol_gamma']

dbToTitle = {'protein': 'Protein (g)',
 'energy': 'Energy (kJ)',
 'carbohydrates': 'Carbohydrates (g)',
 'total_fats': 'Total fats (g)',
 'fatty_acids_total_saturated_200': 'Fatty acids, total saturated 20:0 (g)',
 'fatty_acids_total_saturated_183_undifferentiated': 'Fatty acids, total saturated 18:3 undifferentiated (g)',
 'fatty_acids_total_polyunsaturated_171': 'Fatty acids, total polyunsaturated 17:1 (g)',
 'fatty_acids_total_trans-monoenoic': 'Fatty acids, total trans-monoenoic (g)',
 'fatty_acids_total_saturated_204_undifferentiated': 'Fatty acids, total saturated 20:4 undifferentiated (g)',
 'fatty_acids_total_saturated_40': 'Fatty acids, total saturated 4:0 (g)',
 'fatty_acids_total_trans': 'Fatty acids, total trans (g)',
 'riboflavin': 'Riboflavin (mg)',
 'tocopherol_beta': 'Tocopherol, beta (mg)',
 'lactose': 'Lactose (g)',
 'fatty_acids_total_saturated_225_n-3_': 'Fatty acids, total saturated 22:5 n-3 (DPA) (g)',
 'fatty_acids_total_polyunsaturated_241_c': 'Fatty acids, total polyunsaturated 24:1 c (g)',
 'fatty_acids_total_saturated_184': 'Fatty acids, total saturated 18:4 (g)',
 'fatty_acids_total_saturated_180': 'Fatty acids, total saturated 18:0 (g)',
 'tocopherol_delta': 'Tocopherol, delta (mg)',
 'arginine': 'Arginine (g)',
 'proline': 'Proline (g)',
 'fatty_acids_total_polyunsaturated_181_t': 'Fatty acids, total polyunsaturated 18:1 t (g)',
 'campesterol': 'Campesterol (mg)',
 'glucose_': 'Glucose (dextrose) (g)',
 'adjusted_protein': 'Adjusted Protein (g)',
 'cystine': 'Cystine (g)',
 'tocotrienol_beta': 'Tocotrienol, beta (mg)',
 'selenium_se': 'Selenium, Se (g)',
 'copper_cu': 'Copper, Cu (mg)',
 'maltose': 'Maltose (g)',
 'zinc_zn': 'Zinc, Zn (mg)',
 'total_lipid_': 'Total lipid (fat) (g)',
 'vitamin_k_': 'Vitamin K (phylloquinone) (g)',
 'cholesterol': 'Cholesterol (mg)',
 'fatty_acids_total_saturated_221_undifferentiated': 'Fatty acids, total saturated 22:1 undifferentiated (g)',
 'fatty_acids_total_trans-polyenoic_183_n-3_ccc_': 'Fatty acids, total trans-polyenoic 18:3 n-3 c,c,c (ALA) (g)',
 'menaquinone-4': 'Menaquinone-4 (g)',
 'phytosterols': 'Phytosterols (mg)',
 'folate_total': 'Folate, total (g)',
 'fatty_acids_total_trans-polyenoic_203_n-6': 'Fatty acids, total trans-polyenoic 20:3 n-6 (g)',
 'vitamin_a_iu': 'Vitamin A, IU (IU)',
 'fatty_acids_total_saturated_161_undifferentiated': 'Fatty acids, total saturated 16:1 undifferentiated (g)',
 'fatty_acids_total_saturated_141': 'Fatty acids, total saturated 14:1 (g)',
 'vitamin_d2_': 'Vitamin D2 (ergocalciferol) (g)',
 'methionine': 'Methionine (g)',
 'fatty_acids_total_saturated_205_n-3_': 'Fatty acids, total saturated 20:5 n-3 (EPA) (g)',
 'sugars_total': 'Sugars, total (g)',
 'folic_acid': 'Folic acid (g)',
 'tocotrienol_alpha': 'Tocotrienol, alpha (mg)',
 'vitamin_c_total_ascorbic_acid': 'Vitamin C, total ascorbic acid (mg)',
 'lutein__zeaxanthin': 'Lutein + zeaxanthin (g)',
 'fatty_acids_total_saturated_226_n-3_': 'Fatty acids, total saturated 22:6 n-3 (DHA) (g)',
 'vitamin_b-12_added': 'Vitamin B-12, added (g)',
 'valine': 'Valine (g)',
 'fatty_acids_total_trans-polyenoic_181-11_t_': 'Fatty acids, total trans-polyenoic 18:1-11 t (18:1t n-7) (g)',
 'fatty_acids_total_polyunsaturated_221_c': 'Fatty acids, total polyunsaturated 22:1 c (g)',
 'magnesium_mg': 'Magnesium, Mg (mg)',
 'fatty_acids_total_saturated_160': 'Fatty acids, total saturated 16:0 (g)',
 'carbohydrate_by_difference': 'Carbohydrate, by difference (g)',
 'vitamin_d': 'Vitamin D (IU)',
 'fructose': 'Fructose (g)',
 'fluoride_f': 'Fluoride, F (g)',
 'aspartic_acid': 'Aspartic acid (g)',
 'tyrosine': 'Tyrosine (g)',
 'potassium_k': 'Potassium, K (mg)',
 'fatty_acids_total_saturated_120': 'Fatty acids, total saturated 12:0 (g)',
 'vitamin_a_rae': 'Vitamin A, RAE (g)',
 'serine': 'Serine (g)',
 'fatty_acids_total_trans-polyenoic_215': 'Fatty acids, total trans-polyenoic 21:5 (g)',
 'phenylalanine': 'Phenylalanine (g)',
 'fatty_acids_total_trans-polyenoic_224': 'Fatty acids, total trans-polyenoic 22:4 (g)',
 'alcohol_ethyl': 'Alcohol, ethyl (g)',
 'fatty_acids_total_polyunsaturated_240': 'Fatty acids, total polyunsaturated 24:0 (g)',
 'fatty_acids_total_saturated_220': 'Fatty acids, total saturated 22:0 (g)',
 'fatty_acids_total_saturated_140': 'Fatty acids, total saturated 14:0 (g)',
 'histidine': 'Histidine (g)',
 'isoleucine': 'Isoleucine (g)',
 'fatty_acids_total_polyunsaturated_182_clas': 'Fatty acids, total polyunsaturated 18:2 CLAs (g)',
 'niacin': 'Niacin (mg)',
 'water': 'Water (g)',
 'fatty_acids_total_saturated_80': 'Fatty acids, total saturated 8:0 (g)',
 'tocotrienol_delta': 'Tocotrienol, delta (mg)',
 'theobromine': 'Theobromine (mg)',
 'fatty_acids_total_polyunsaturated_202_n-6_cc': 'Fatty acids, total polyunsaturated 20:2 n-6 c,c (g)',
 'carotene_beta': 'Carotene, beta (g)',
 'sodium_na': 'Sodium, Na (mg)',
 'iron_fe': 'Iron, Fe (mg)',
 'ash': 'Ash (g)',
 'caffeine': 'Caffeine (mg)',
 'glycine': 'Glycine (g)',
 'fatty_acids_total_trans-polyenoic': 'Fatty acids, total trans-polyenoic (g)',
 'fatty_acids_total_polyunsaturated_183_n-6_ccc': 'Fatty acids, total polyunsaturated 18:3 n-6 c,c,c (g)',
 'fatty_acids_total_saturated_182_undifferentiated': 'Fatty acids, total saturated 18:2 undifferentiated (g)',
 'fatty_acids_total_polyunsaturated': 'Fatty acids, total polyunsaturated (g)',
 'vitamin_e_': 'Vitamin E (alpha-tocopherol) (mg)',
 'sucrose': 'Sucrose (g)',
 'vitamin_b-6': 'Vitamin B-6 (mg)',
 'fatty_acids_total_trans-polyenoic_130': 'Fatty acids, total trans-polyenoic 13:0 (g)',
 'fatty_acids_total_saturated_60': 'Fatty acids, total saturated 6:0 (g)',
 'vitamin_d_': 'Vitamin D (D2 + D3) (g)',
 'vitamin_d3_': 'Vitamin D3 (cholecalciferol) (g)',
 'lysine': 'Lysine (g)',
 'beta-sitosterol': 'Beta-sitosterol (mg)',
 'fatty_acids_total_polyunsaturated_203_undifferentiated': 'Fatty acids, total polyunsaturated 20:3 undifferentiated (g)',
 'fatty_acids_total_trans-polyenoic_151': 'Fatty acids, total trans-polyenoic 15:1 (g)',
 'lycopene': 'Lycopene (g)',
 'starch': 'Starch (g)',
 'pantothenic_acid': 'Pantothenic acid (mg)',
 'fatty_acids_total_trans-polyenoic_204_n-6': 'Fatty acids, total trans-polyenoic 20:4 n-6 (g)',
 'fatty_acids_total_polyunsaturated_182_tt': 'Fatty acids, total polyunsaturated 18:2 t,t (g)',
 'fatty_acids_total_polyunsaturated_150': 'Fatty acids, total polyunsaturated 15:0 (g)',
 'fatty_acids_total_trans-polyenoic_183i': 'Fatty acids, total trans-polyenoic 18:3i (g)',
 'thiamin': 'Thiamin (mg)',
 'folate_food': 'Folate, food (g)',
 'fatty_acids_total_saturated_201': 'Fatty acids, total saturated 20:1 (g)',
 'fatty_acids_total_monounsaturated': 'Fatty acids, total monounsaturated (g)',
 'stigmasterol': 'Stigmasterol (mg)',
 'fatty_acids_total_polyunsaturated_182_n-6_cc': 'Fatty acids, total polyunsaturated 18:2 n-6 c,c (g)',
 'fatty_acids_total_polyunsaturated_161_t': 'Fatty acids, total polyunsaturated 16:1 t (g)',
 'fatty_acids_total_polyunsaturated_170': 'Fatty acids, total polyunsaturated 17:0 (g)',
 'fatty_acids_total_polyunsaturated_182_i': 'Fatty acids, total polyunsaturated 18:2 i (g)',
 'hydroxyproline': 'Hydroxyproline (g)',
 'dihydrophylloquinone': 'Dihydrophylloquinone (g)',
 'choline_total': 'Choline, total (mg)',
 'fatty_acids_total_polyunsaturated_161_c': 'Fatty acids, total polyunsaturated 16:1 c (g)',
 'fatty_acids_total_saturated': 'Fatty acids, total saturated (g)',
 'vitamin_b-12': 'Vitamin B-12 (g)',
 'calcium_ca': 'Calcium, Ca (mg)',
 'fatty_acids_total_saturated_100': 'Fatty acids, total saturated 10:0 (g)',
 'galactose': 'Galactose (g)',
 'tocotrienol_gamma': 'Tocotrienol, gamma (mg)',
 'alanine': 'Alanine (g)',
 'glutamic_acid': 'Glutamic acid (g)',
 'fatty_acids_total_trans-polyenoic_203_n-3': 'Fatty acids, total trans-polyenoic 20:3 n-3 (g)',
 'carotene_alpha': 'Carotene, alpha (g)',
 'vitamin_e_added': 'Vitamin E, added (mg)',
 'retinol': 'Retinol (g)',
 'leucine': 'Leucine (g)',
 'folate_dfe': 'Folate, DFE (g)',
 'fatty_acids_total_polyunsaturated_221_t': 'Fatty acids, total polyunsaturated 22:1 t (g)',
 'fatty_acids_total_polyunsaturated_182_t_not_further_defined': 'Fatty acids, total polyunsaturated 18:2 t not further defined (g)',
 'fiber_total_dietary': 'Fiber, total dietary (g)',
 'tryptophan': 'Tryptophan (g)',
 'threonine': 'Threonine (g)',
 'fatty_acids_total_polyunsaturated_181_c': 'Fatty acids, total polyunsaturated 18:1 c (g)',
 'manganese_mn': 'Manganese, Mn (mg)',
 'cryptoxanthin_beta': 'Cryptoxanthin, beta (g)',
 'fatty_acids_total_saturated_181_undifferentiated': 'Fatty acids, total saturated 18:1 undifferentiated (g)',
 'betaine': 'Betaine (mg)',
 'phosphorus_p': 'Phosphorus, P (mg)',
 'tocopherol_gamma': 'Tocopherol, gamma (mg)'
}

titleToDb = {'Protein (g)': 'protein',
 'Energy (kCal)': 'energy',
 'Carbohydrates (g)': 'carbohydrates',
 'Total fats (g)': 'total_fats',
 'Fatty acids, total saturated 20:0 (g)': 'fatty_acids_total_saturated_200',
 'Fatty acids, total saturated 18:3 undifferentiated (g)': 'fatty_acids_total_saturated_183_undifferentiated',
 'Fatty acids, total polyunsaturated 17:1 (g)': 'fatty_acids_total_polyunsaturated_171',
 'Fatty acids, total trans-monoenoic (g)': 'fatty_acids_total_trans-monoenoic',
 'Fatty acids, total saturated 20:4 undifferentiated (g)': 'fatty_acids_total_saturated_204_undifferentiated',
 'Fatty acids, total saturated 4:0 (g)': 'fatty_acids_total_saturated_40',
 'Fatty acids, total trans (g)': 'fatty_acids_total_trans',
 'Riboflavin (mg)': 'riboflavin',
 'Tocopherol, beta (mg)': 'tocopherol_beta',
 'Lactose (g)': 'lactose',
 'Fatty acids, total saturated 22:5 n-3 (DPA) (g)': 'fatty_acids_total_saturated_225_n-3_',
 'Fatty acids, total polyunsaturated 24:1 c (g)': 'fatty_acids_total_polyunsaturated_241_c',
 'Fatty acids, total saturated 18:4 (g)': 'fatty_acids_total_saturated_184',
 'Fatty acids, total saturated 18:0 (g)': 'fatty_acids_total_saturated_180',
 'Tocopherol, delta (mg)': 'tocopherol_delta',
 'Arginine (g)': 'arginine',
 'Proline (g)': 'proline',
 'Fatty acids, total polyunsaturated 18:1 t (g)': 'fatty_acids_total_polyunsaturated_181_t',
 'Campesterol (mg)': 'campesterol',
 'Glucose (dextrose) (g)': 'glucose_',
 'Adjusted Protein (g)': 'adjusted_protein',
 'Cystine (g)': 'cystine',
 'Tocotrienol, beta (mg)': 'tocotrienol_beta',
 'Selenium, Se (g)': 'selenium_se',
 'Copper, Cu (mg)': 'copper_cu',
 'Maltose (g)': 'maltose',
 'Zinc, Zn (mg)': 'zinc_zn',
 'Total lipid (fat) (g)': 'total_lipid_',
 'Vitamin K (phylloquinone) (g)': 'vitamin_k_',
 'Cholesterol (mg)': 'cholesterol',
 'Fatty acids, total saturated 22:1 undifferentiated (g)': 'fatty_acids_total_saturated_221_undifferentiated',
 'Fatty acids, total trans-polyenoic 18:3 n-3 c,c,c (ALA) (g)': 'fatty_acids_total_trans-polyenoic_183_n-3_ccc_',
 'Menaquinone-4 (g)': 'menaquinone-4',
 'Phytosterols (mg)': 'phytosterols',
 'Folate, total (g)': 'folate_total',
 'Fatty acids, total trans-polyenoic 20:3 n-6 (g)': 'fatty_acids_total_trans-polyenoic_203_n-6',
 'Vitamin A, IU (IU)': 'vitamin_a_iu',
 'Energy (kcal)': 'energy',
 'Fatty acids, total saturated 16:1 undifferentiated (g)': 'fatty_acids_total_saturated_161_undifferentiated',
 'Fatty acids, total saturated 14:1 (g)': 'fatty_acids_total_saturated_141',
 'Vitamin D2 (ergocalciferol) (g)': 'vitamin_d2_',
 'Methionine (g)': 'methionine',
 'Fatty acids, total saturated 20:5 n-3 (EPA) (g)': 'fatty_acids_total_saturated_205_n-3_',
 'Sugars, total (g)': 'sugars_total',
 'Folic acid (g)': 'folic_acid',
 'Tocotrienol, alpha (mg)': 'tocotrienol_alpha',
 'Vitamin C, total ascorbic acid (mg)': 'vitamin_c_total_ascorbic_acid',
 'Lutein + zeaxanthin (g)': 'lutein__zeaxanthin',
 'Fatty acids, total saturated 22:6 n-3 (DHA) (g)': 'fatty_acids_total_saturated_226_n-3_',
 'Vitamin B-12, added (g)': 'vitamin_b-12_added',
 'Valine (g)': 'valine',
 'Fatty acids, total trans-polyenoic 18:1-11 t (18:1t n-7) (g)': 'fatty_acids_total_trans-polyenoic_181-11_t_',
 'Fatty acids, total polyunsaturated 22:1 c (g)': 'fatty_acids_total_polyunsaturated_221_c',
 'Magnesium, Mg (mg)': 'magnesium_mg',
 'Fatty acids, total saturated 16:0 (g)': 'fatty_acids_total_saturated_160',
 'Carbohydrate, by difference (g)': 'carbohydrate_by_difference',
 'Vitamin D (IU)': 'vitamin_d',
 'Fructose (g)': 'fructose',
 'Fluoride, F (g)': 'fluoride_f',
 'Aspartic acid (g)': 'aspartic_acid',
 'Tyrosine (g)': 'tyrosine',
 'Potassium, K (mg)': 'potassium_k',
 'Fatty acids, total saturated 12:0 (g)': 'fatty_acids_total_saturated_120',
 'Vitamin A, RAE (g)': 'vitamin_a_rae',
 'Serine (g)': 'serine',
 'Fatty acids, total trans-polyenoic 21:5 (g)': 'fatty_acids_total_trans-polyenoic_215',
 'Phenylalanine (g)': 'phenylalanine',
 'Fatty acids, total trans-polyenoic 22:4 (g)': 'fatty_acids_total_trans-polyenoic_224',
 'Alcohol, ethyl (g)': 'alcohol_ethyl',
 'Fatty acids, total polyunsaturated 24:0 (g)': 'fatty_acids_total_polyunsaturated_240',
 'Fatty acids, total saturated 22:0 (g)': 'fatty_acids_total_saturated_220',
 'Fatty acids, total saturated 14:0 (g)': 'fatty_acids_total_saturated_140',
 'Histidine (g)': 'histidine',
 'Isoleucine (g)': 'isoleucine',
 'Fatty acids, total polyunsaturated 18:2 CLAs (g)': 'fatty_acids_total_polyunsaturated_182_clas',
 'Niacin (mg)': 'niacin',
 'Water (g)': 'water',
 'Fatty acids, total saturated 8:0 (g)': 'fatty_acids_total_saturated_80',
 'Tocotrienol, delta (mg)': 'tocotrienol_delta',
 'Theobromine (mg)': 'theobromine',
 'Fatty acids, total polyunsaturated 20:2 n-6 c,c (g)': 'fatty_acids_total_polyunsaturated_202_n-6_cc',
 'Carotene, beta (g)': 'carotene_beta',
 'Sodium, Na (mg)': 'sodium_na',
 'Iron, Fe (mg)': 'iron_fe',
 'Energy (kJ)': 'energy',
 'Ash (g)': 'ash',
 'Caffeine (mg)': 'caffeine',
 'Glycine (g)': 'glycine',
 'Fatty acids, total trans-polyenoic (g)': 'fatty_acids_total_trans-polyenoic',
 'Fatty acids, total polyunsaturated 18:3 n-6 c,c,c (g)': 'fatty_acids_total_polyunsaturated_183_n-6_ccc',
 'Fatty acids, total saturated 18:2 undifferentiated (g)': 'fatty_acids_total_saturated_182_undifferentiated',
 'Fatty acids, total polyunsaturated (g)': 'fatty_acids_total_polyunsaturated',
 'Vitamin E (alpha-tocopherol) (mg)': 'vitamin_e_',
 'Sucrose (g)': 'sucrose',
 'Vitamin B-6 (mg)': 'vitamin_b-6',
 'Fatty acids, total trans-polyenoic 13:0 (g)': 'fatty_acids_total_trans-polyenoic_130',
 'Fatty acids, total saturated 6:0 (g)': 'fatty_acids_total_saturated_60',
 'Vitamin D (D2 + D3) (g)': 'vitamin_d_',
 'Vitamin D3 (cholecalciferol) (g)': 'vitamin_d3_',
 'Lysine (g)': 'lysine',
 'Beta-sitosterol (mg)': 'beta-sitosterol',
 'Fatty acids, total polyunsaturated 20:3 undifferentiated (g)': 'fatty_acids_total_polyunsaturated_203_undifferentiated',
 'Fatty acids, total trans-polyenoic 15:1 (g)': 'fatty_acids_total_trans-polyenoic_151',
 'Lycopene (g)': 'lycopene',
 'Starch (g)': 'starch',
 'Pantothenic acid (mg)': 'pantothenic_acid',
 'Fatty acids, total trans-polyenoic 20:4 n-6 (g)': 'fatty_acids_total_trans-polyenoic_204_n-6',
 'Fatty acids, total polyunsaturated 18:2 t,t (g)': 'fatty_acids_total_polyunsaturated_182_tt',
 'Fatty acids, total polyunsaturated 15:0 (g)': 'fatty_acids_total_polyunsaturated_150',
 'Fatty acids, total trans-polyenoic 18:3i (g)': 'fatty_acids_total_trans-polyenoic_183i',
 'Thiamin (mg)': 'thiamin',
 'Folate, food (g)': 'folate_food',
 'Fatty acids, total saturated 20:1 (g)': 'fatty_acids_total_saturated_201',
 'Fatty acids, total monounsaturated (g)': 'fatty_acids_total_monounsaturated',
 'Stigmasterol (mg)': 'stigmasterol',
 'Fatty acids, total polyunsaturated 18:2 n-6 c,c (g)': 'fatty_acids_total_polyunsaturated_182_n-6_cc',
 'Fatty acids, total polyunsaturated 16:1 t (g)': 'fatty_acids_total_polyunsaturated_161_t',
 'Fatty acids, total polyunsaturated 17:0 (g)': 'fatty_acids_total_polyunsaturated_170',
 'Fatty acids, total polyunsaturated 18:2 i (g)': 'fatty_acids_total_polyunsaturated_182_i',
 'Hydroxyproline (g)': 'hydroxyproline',
 'Dihydrophylloquinone (g)': 'dihydrophylloquinone',
 'Choline, total (mg)': 'choline_total',
 'Fatty acids, total polyunsaturated 16:1 c (g)': 'fatty_acids_total_polyunsaturated_161_c',
 'Fatty acids, total saturated (g)': 'fatty_acids_total_saturated',
 'Vitamin B-12 (g)': 'vitamin_b-12',
 'Calcium, Ca (mg)': 'calcium_ca',
 'Fatty acids, total saturated 10:0 (g)': 'fatty_acids_total_saturated_100',
 'Galactose (g)': 'galactose',
 'Tocotrienol, gamma (mg)': 'tocotrienol_gamma',
 'Alanine (g)': 'alanine',
 'Glutamic acid (g)': 'glutamic_acid',
 'Fatty acids, total trans-polyenoic 20:3 n-3 (g)': 'fatty_acids_total_trans-polyenoic_203_n-3',
 'Carotene, alpha (g)': 'carotene_alpha',
 'Vitamin E, added (mg)': 'vitamin_e_added',
 'Retinol (g)': 'retinol',
 'Leucine (g)': 'leucine',
 'Folate, DFE (g)': 'folate_dfe',
 'Fatty acids, total polyunsaturated 22:1 t (g)': 'fatty_acids_total_polyunsaturated_221_t',
 'Fatty acids, total polyunsaturated 18:2 t not further defined (g)': 'fatty_acids_total_polyunsaturated_182_t_not_further_defined',
 'Fiber, total dietary (g)': 'fiber_total_dietary',
 'Tryptophan (g)': 'tryptophan',
 'Threonine (g)': 'threonine',
 'Fatty acids, total polyunsaturated 18:1 c (g)': 'fatty_acids_total_polyunsaturated_181_c',
 'Manganese, Mn (mg)': 'manganese_mn',
 'Cryptoxanthin, beta (g)': 'cryptoxanthin_beta',
 'Fatty acids, total saturated 18:1 undifferentiated (g)': 'fatty_acids_total_saturated_181_undifferentiated',
 'Betaine (mg)': 'betaine',
 'Phosphorus, P (mg)': 'phosphorus_p',
 'Tocopherol, gamma (mg)': 'tocopherol_gamma'}

columns = [
    "ingName",
    "ingId",
    "qt",
    "unit",
    "state",
    "energy",
    "carbs",
    "prot",
    "fat"
]

def extract_number_from_url(url):
    # Find the last occurrence of '/' in the URL
    last_slash_index = url.find('/')
    
    # Get the substring after the last '/'
    substring = url[last_slash_index + 1:]
    
    # Remove any non-digit characters from the substring
    number = ''.join(char for char in substring if char.isdigit())
    
    return number

url = "https://cosylab.iiitd.edu.in/recipedb/"

import asyncio
import re
import time
import nltk
import pandas as pd
from tqdm import tqdm
from selenium import webdriver
from bs4 import BeautifulSoup
from selenium.webdriver.common.keys import Keys
from webdriver_manager.chrome import ChromeDriverManager
from algoliasearch.search_client import SearchClient

options = webdriver.ChromeOptions()

options.add_argument("--disable-blink-features=AutomationControlled") 
 
# Exclude the collection of enable-automation switches 
options.add_experimental_option("excludeSwitches", ["enable-automation"]) 
 
# Turn-off userAutomationExtension 
options.add_experimental_option("useAutomationExtension", False) 
 
# Setting the driver path and requesting a page 
driver = webdriver.Chrome(ChromeDriverManager().install(), options=options) 

driver.get(url)
# pageText = driver.page_source
# soup = BeautifulSoup(pageText, 'html.parser')
# categories = soup.find_all("g", {"class": "ditem"})

# parsedCategories = []
# for category in categories:
#     categoryText = category.text
#     parsedCategory = categoryText.lower().replace(" ", "-")
#     parsedCategories.append(parsedCategory)
    
# searchedData = []
# for category in parsedCategories:
#     currentUrl = url + "#" + category
#     driver.get(currentUrl)
#     time.sleep(0.1)
#     pageText = driver.page_source
#     soup = BeautifulSoup(pageText, 'html.parser')
#     texts = soup.find_all("text")
#     for text in texts:
#         ingredient = text.text
#         if ingredient not in searchedData:
#             searchedData.append(ingredient)
recipeSearch = "https://cosylab.iiitd.edu.in/recipedb/search_recipe"
driver.get(url)
button = driver.find_element_by_xpath('/html/body/div[2]/div[4]/div/div[3]/form/div[2]/center/input')
button.click()
time.sleep(3)

hrefs = []
for i in tqdm(range(10_000, 99989)):
    hrefs.append(f"/recipedb/search_recipeInfo/{i}")
    
baseUrl = "https://cosylab.iiitd.edu.in"
datas = []

def calculate_health_score(kcal, carbs, protein, fat):
    # Assign weights to each macronutrient
    carbs_weight = 2
    protein_weight = 3
    fat_weight = 1
    
    # Calculate the percentage of calories from each macronutrient
    carbs_percentage = (carbs * 4) / kcal * 100
    protein_percentage = (protein * 4) / kcal * 100
    fat_percentage = (fat * 9) / kcal * 100
    
    # Compute the weighted sum
    health_score = (carbs_percentage * carbs_weight + protein_percentage * protein_weight + fat_percentage * fat_weight) / 10
    
    return health_score
k = 0
for href in tqdm(hrefs[100:]):
    k+=1
    try:
        driver.get(baseUrl + href)
        pageText = driver.page_source
        soup = BeautifulSoup(pageText, 'html.parser')
        table = soup.find("table", {"class": "highlight striped"})
        recipeData = {}
        for row in table.find_all("tr"):
            category = row.find("strong")
            if (category != None):
                category = category.text
                value = row.find_all('td')[1]
                valueNum = value.text
                try:
                    recipeData[titleToDb[category]] = float(valueNum) 
                except:
                    pass

        dataId = extract_number_from_url(href)
        print(dataId)
        recipeData['objectID'] = dataId
        
        recipeDatacollection = soup.find("ul", {'class': 'collection'})
        url = recipeDatacollection.find("a").get('href')
        recipeData['url'] = url

        driver.get(baseUrl + href + "#ingredient_nutri")
        table = soup.find_all("tbody")[1]

        ingredients = []
        directList = []
        for row in table.find_all("tr"):
            tds = row.find_all('td')
            ingredientList = {}
            for i in range(len(tds)):
                td = tds[i]
                value = td.text
                if i == 0:
                    directList.append(value)
                col = columns[i]
                try:
                    value = float(value)
                except:
                    pass
                if value == "-":
                    value = 0
                ingredientList[col] = value
            ingredients.append(ingredientList) 

        recipeData['ingredientsDetailed'] = ingredients
        recipeData['ingredients'] = directList
        recipeData['_tags'] = directList
        
        title = soup.find("h3").text
        try:    
            link = soup.find("img", {'class': 'responsive-img'}).get('src')
        except:
            link = ""
        recipeData['title'] = title
        recipeData['img'] = link
        recipeData['healthScore'] = calculate_health_score(recipeData['energy'], recipeData['carbohydrates'], recipeData['protein'], recipeData['total_fats'])
        datas.append(recipeData)
        if k%100==0:
            datasDF = pd.DataFrame(datas)
            datasDF.to_csv('datas.csv')
            
    except:
        continue

datasDF = pd.DataFrame(datas)
datasDF.to_csv('datas.csv')
client = SearchClient.create("BNUFEQQJJG", "2b51428570ed2e2651eb359fe186c64d")
index = client.init_index("easymeal")

## chunk datas into 1000s

for i in range(0, len(datas), 1000):
    datasChunk = datas[i:i+1000]
    index.save_objects(datasChunk).wait()
        

